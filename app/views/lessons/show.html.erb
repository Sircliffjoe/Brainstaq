<% content_for :title do %>
  <%= @course.title %>
<% end %>

<!-- start of page-header -->
<section class="page-header bg-light-gray has-shapes has-bg-brash bg-brash-bottom" style="margin-bottom:50px; background-image: url(<%= image_path "banner.svg" %>)">
  <div class="container h-100">
      <div class="row d-flex align-items-center h-100">
          <div class="col-md-12 text-center">
              <h2 class="h1 font-weight-bold">Course Details</h2>
              <nav class="mt-15" aria-label="breadcrumb">
                  <ol class="breadcrumb font-weight-bold bg-transparent p-0 justify-content-center">
                      <li class="breadcrumb-item"><%= link_to "Courses", courses_path, class: "text-black-300" %></li>
                      <li class="breadcrumb-item text-primary" aria-current="page"><%= @course.title %></li>
                  </ol>
              </nav>
          </div>
      </div>
  </div>

  <div class="shape-1 bg-secondary shape-xs rounded-circle"></div>
  <div class="shape-2 bg-primary shape-xs-2 rounded-circle"></div>
  <div class="shape-3 bg-primary shape-sm-2 rounded-circle"></div>
  <div class="shape-4 bg-tertiary shape-xs rounded-circle"></div>
  <div class="shape-5 bg-tertiary shape-xs rounded-circle"></div>
  <div class="shape-6 bg-primary shape-sm rounded-circle"></div>
  <div class="shape-7 bg-primary shape-xs-2 rounded-circle"></div>
  <div class="shape-8 bg-secondary shape-xs rounded-circle"></div>
</section>
<!-- end of page-header -->

<div class="row col-lg-12">
  <div class="col-lg-8">
    <div class="card shadow">
      <div class="card-header">
        <div class="text-success">
          <i class="fa fa-check-square"></i>
          <%= link_to course_lesson_path(@course, @lesson, anchor: "current_lesson") do %>
            <b>
              <%= @lesson.chapter.row_order_rank + 1 %>.
              <%= @lesson.row_order_rank + 1 %>.
            </b>
            <%= @lesson.title %>
          <% end %>
        </div>
      </div>
      
      <div class="card-body">
        <% if @lesson.vimeo.present? %>
          <div class="video-container mb-5">
            <% if @lesson.vimeo.include?("youtube.com") || @lesson.vimeo.include?("youtu.be") %>
              <% youtube_id = if @lesson.vimeo.include?("youtube.com")
                                @lesson.vimeo.split('v=').last.split('&').first
                              else
                                @lesson.vimeo.split('/').last
                              end %>
              <iframe class="embed-responsive embed-responsive-16by9" src="https://www.youtube.com/embed/<%= youtube_id %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <% elsif @lesson.vimeo.include?("vimeo.com") %>
              <% vimeo_id = @lesson.vimeo.split('/').last.split('?').first %>
              <iframe class="embed-responsive embed-responsive-16by9" src="https://player.vimeo.com/video/<%= vimeo_id %>" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
            <% else %>
              <p>Invalid video URL</p>
            <% end %>
          </div>
        <% end %>
        <%= @lesson.content %>
      </div>
      
      <% if current_user.admin? %>
        <div class="card-footer">
          <%= link_to edit_course_lesson_path(@course, @lesson), class: 'btn btn-sm btn-warning mr-1' do %>
            <i class="fa fa-edit"></i>
          <% end %>
          <%= link_to [@course, @lesson], method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' do %>
            <i class="fa fa-trash"></i>
          <% end %>
        </div>
      <% end %>
      <div class="card-footer">
        <% unless @lesson.prev.nil? %>
          <div class="float-left">
            <%= link_to course_lesson_path(@course, @lesson.prev, anchor: "current_lesson"), class: 'btn btn-sm btn-info' do %>
              <i class="fa fa-arrow-left"></i>
              Previous
            <% end %>
          </div>
        <% end %>
        <% unless @lesson.next.nil? %>
          <div class="float-right">
            <%= link_to course_lesson_path(@course, @lesson.next, anchor: "current_lesson"), class: 'btn btn-sm btn-info' do %>
              <i class="fa fa-arrow-right"></i>
              Next
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
    <p></p>
    <h4>
      <i class="fa fa-comment"></i>
      Comments: (<%= @lesson.comments.size %>)
    </h4>
    <div class="card shadow">
      <div class="card-header">
        New comment
      </div>
      <div class="card-body">
        <%= render partial: 'comments/form', locals: { comment: Comment.new, commentable: @lesson, comment_path: polymorphic_path([@course, @lesson, Comment.new]) } %>
      </div>
    </div>
    <div class="list-group">
      <% @comments.each do |comment| %>
        <div class="list-group-item">
          <%= render 'lessons/comments/comment', comment: comment %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="list-group shadow">
    <div class="list-group-item">
      <i class="fa fa-graduation-cap fa-2x"></i>
      <%= link_to course_path(@lesson.course), style: "font-size: 18px;" do %>
        <%= @lesson.course.title %>
      <% end %>
      <div class="row mt-2">
        <div class="col-12">
          <div class="progress">
            <div class="progress-bar bg-secondary text-dark" role="progressbar" style="width: <%= @course.progress(current_user) %>%;" aria-valuenow="<%= @course.progress(current_user) %>" aria-valuemin="0" aria-valuemax="100">
              <%= number_to_percentage(@course.progress(current_user), precision: 0) %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    <div id="accordion">
      <% @chapters.each_with_index do |chapter, index| %>
        <div class="card mb-1">
          <div class="card-header" id="heading<%= index %>">
            <h5 class="mb-0">
              <button class="btn btn-link" data-toggle="collapse" data-target="#collapse<%= index %>" aria-expanded="<%= index == 0 %>" aria-controls="collapse<%= index %>">
                <%= chapter.title %>
              </button>
            </h5>
          </div>

          <div id="collapse<%= index %>" class="collapse <%= 'show' if index == 0 %>" aria-labelledby="heading<%= index %>" data-parent="#accordion">
            <div class="card-body">
              <% chapter.lessons.rank(:row_order).each do |lesson| %>
                <div class="list-group">
                  <% if lesson.eql?(@lesson) %>
                    <a href="#" class="list-group-item list-group-item-success">
                      <%= render 'lessons/lesson', lesson: lesson %>
                    </a>
                  <% else %>
                    <a href="#" class="list-group-item list-group-item-secondary">
                      <%= render 'lessons/lesson', lesson: lesson %>
                    </a>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
<br>

<style>

.progress {
  height: 20px;
  background-color: #f1f1f1;
  border-radius: 5px;
}

.progress-bar {
  font-size: 12px;
  line-height: 20px;
}

/* Custom styles for accordion */
.card-header {
  background-color: #f8f9fa;
}

.card-header .btn-link {
  font-weight: bold;
  text-decoration: none;
}

.card-header .btn-link:hover {
  text-decoration: none;
  color: #0056b3;
}

.card {
  border-radius: 5px;
}

.list-group-item {
  border-radius: 5px;
  margin-bottom: 5px;
  border: none;
}

.list-group-item-success {
  background-color: #d4edda;
  border-color: #c3e6cb;
}

.list-group-item-secondary {
  background-color: #f8f9fa;
  border-color: #e2e6ea;
}

.list-group-item-success:hover,
.list-group-item-secondary:hover {
  background-color: #e9ecef;
}

.video-container {
  position: relative;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  height: 0;
  overflow: hidden;
  max-width: 100%;
  background: #000;
}

.video-container iframe,
.video-container object,
.video-container embed {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

@media (max-width: 360px) {
  
}
</style>


"Bethesda Gospel Mission","07031185377"
"Bride Preview Tabanacle","08050203897"
"CGMI Church Amazing","07089881247"
"Champions Christian","08023566881"
"Christ Batist Church","08037743407"
"Christ Gospel Church","08036753291"
"Christ's Revival CREM","070634479710"
"Covenant Activaters Life","08037711051"
"Covenant Glory Living","08062152149"
"Ebenezer Baptist Church","08061426719"
"First Christ Apostolic","08087950697"
"Fountain of Life Charis","08065332254"
"Glory Baptist Church","08037920316"
"Gospel Faith Mission Int","08152131478"
"Gospel Pillars Church","08165254593"
"Heaven on Earth Ministry","08033736691"
"Holy Ghost Dunamis","08035058772"
"Lifted Christ Upc","08033990254"
"Living Faith Church","08069710751"
"Living Faith-Church","08102782774"
"Omega Prophetic Prayer","08133660285"
"RCCG Royal Priests","08066455974"
"RCCG Seat of Power","08067173762"
"Resurrection Gospel","09033268831"
"Royal Champions Faith","08035608473"
"Sapele Methodist Church","08188840099"
"Shammah Praise Centre","07032449776"
"St Joseph Chosen Church","08028626170"
"Streams of Grace Global","08147935539"
"Success Impact","08030694809"
"The Kings Palace Global","08037399938"
"International Christ Mission","08035830265"
"Unity Baptist Church Sapele","08063718081"
"Victory Baptist Church","08066378820"
"Victory Int'l Family","08035783613"
"Zion Missionary","07037003090"